(this["webpackJsonpreact-drive-clone"]=this["webpackJsonpreact-drive-clone"]||[]).push([[0],{72:function(e,t,r){},73:function(e,t,r){},86:function(e,t,r){"use strict";r.r(t);var c=r(0),n=r.n(c),a=r(26),s=r.n(a),i=(r(72),r(73),r(11)),l=r(13),o=r(21),d=r.n(o),j=r(31),u=r(10),b=r(100),h=r(92),O=r(95),f=r(93),p=r(14),x=r(61),m=(r(75),r(87),r(88),x.a.initializeApp({apiKey:"AIzaSyAoO3GdNGndKNvYNOl4dre-RIcA0dcIyz8",authDomain:"react-drive-clone.firebaseapp.com",projectId:"react-drive-clone",storageBucket:"react-drive-clone.appspot.com",messagingSenderId:"305157278931",appId:"1:305157278931:web:e9e9867ae9458afa31d826"})),v=m.firestore(),g={folders:v.collection("folders"),files:v.collection("files"),formatDoc:function(e){return Object(p.a)({id:e.id},e.data())},getCurrentTimestamp:x.a.firestore.FieldValue.serverTimestamp},w=m.storage(),y=m.auth(),N=r(2),F=n.a.createContext();function P(){return Object(c.useContext)(F)}function S(e){var t=e.children,r=Object(c.useState)(),n=Object(u.a)(r,2),a=n[0],s=n[1],i=Object(c.useState)(!0),l=Object(u.a)(i,2),o=l[0],d=l[1];Object(c.useEffect)((function(){return y.onAuthStateChanged((function(e){s(e),d(!1)}))}),[]);var j={currentUser:a,signup:function(e,t){return y.createUserWithEmailAndPassword(e,t)},login:function(e,t){return y.signInWithEmailAndPassword(e,t)},logout:function(){return y.signOut()},forgotPassword:function(e){return y.sendPasswordResetEmail(e)},updateEmail:function(e){return a.updateEmail(e)},updatePassword:function(e){return a.updatePassword(e)}};return Object(N.jsx)(F.Provider,{value:j,children:!o&&t})}var C=r(91);function I(e){var t=e.children;return Object(N.jsx)(C.a,{className:"container d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(N.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:t})})}var k=function(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),n=P().signup,a=Object(c.useState)(""),s=Object(u.a)(a,2),l=s[0],o=s[1],p=Object(c.useState)(!1),x=Object(u.a)(p,2),m=x[0],v=x[1];function g(){return(g=Object(j.a)(d.a.mark((function c(a){return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(a.preventDefault(),t.current.value===r.current.value){c.next=3;break}return c.abrupt("return",o("Passwords do not match!!"));case 3:return c.prev=3,o(""),v(!0),c.next=8,n(e.current.value,t.current.value);case 8:c.next=13;break;case 10:c.prev=10,c.t0=c.catch(3),o("Failed to create an account");case 13:v(!1);case 14:case"end":return c.stop()}}),c,null,[[3,10]])})))).apply(this,arguments)}return Object(N.jsxs)(I,{children:[Object(N.jsx)(b.a,{children:Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h2",{className:"text-center mb-4",children:"Sign Up"}),l&&Object(N.jsx)(h.a,{variant:"danger",children:l}),Object(N.jsxs)(O.a,{onSubmit:function(e){return g.apply(this,arguments)},children:[Object(N.jsxs)(O.a.Group,{id:"email",children:[Object(N.jsx)(O.a.Label,{children:"Email"}),Object(N.jsx)(O.a.Control,{type:"email",ref:e,placeholder:"Email",required:!0})]}),Object(N.jsxs)(O.a.Group,{id:"password",children:[Object(N.jsx)(O.a.Label,{children:"Password"}),Object(N.jsx)(O.a.Control,{type:"password",ref:t,placeholder:"Password",required:!0})]}),Object(N.jsxs)(O.a.Group,{id:"passwordConfirm",children:[Object(N.jsx)(O.a.Label,{children:"Password Confirmation"}),Object(N.jsx)(O.a.Control,{type:"password",ref:r,placeholder:"Confirm Password",required:!0})]}),Object(N.jsx)(f.a,{disabled:m,type:"submit",className:"w-100",children:"Sign Up"})]})]})}),Object(N.jsxs)("div",{className:"w-100 text-center mt-2",children:["Already have an account? ",Object(N.jsx)(i.b,{to:"/login",children:"Log In"})]})]})};var E=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),r=t[0],n=t[1],a=P(),s=a.currentUser,o=a.logout,O=Object(l.g)();function p(){return(p=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(""),e.prev=1,e.next=4,o();case 4:O.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n("Failed To Logout");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}return Object(N.jsxs)(I,{children:[Object(N.jsx)(b.a,{children:Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h2",{className:"text-center mb-4",children:"Profile"}),r&&Object(N.jsx)(h.a,{variant:"danger",children:r}),Object(N.jsx)("strong",{children:"Email: "})," ",s.email,Object(N.jsx)(i.b,{to:"/update-profile",className:"btn btn-primary w-100 mt-3",children:"Update Profile"})]})}),Object(N.jsxs)("div",{className:"w-100 text-center mt-2 d-flex align-items-center justify-content-center",children:[Object(N.jsx)(i.b,{variant:"link",to:"/",children:"Back"}),Object(N.jsx)(f.a,{variant:"link",onClick:function(){return p.apply(this,arguments)},children:"Log Out"})]})]})},L=function(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=P().login,n=Object(c.useState)(""),a=Object(u.a)(n,2),s=a[0],o=a[1],p=Object(c.useState)(!1),x=Object(u.a)(p,2),m=x[0],v=x[1],g=Object(l.g)();function w(){return(w=Object(j.a)(d.a.mark((function c(n){return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n.preventDefault(),c.prev=1,o(""),v(!0),c.next=6,r(e.current.value,t.current.value);case 6:g.push("/"),c.next=12;break;case 9:c.prev=9,c.t0=c.catch(1),o("Failed to Sign In");case 12:v(!1);case 13:case"end":return c.stop()}}),c,null,[[1,9]])})))).apply(this,arguments)}return Object(N.jsxs)(I,{children:[Object(N.jsx)(b.a,{children:Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h2",{className:"text-center mb-4",children:"Log In"}),s&&Object(N.jsx)(h.a,{variant:"danger",children:s}),Object(N.jsxs)(O.a,{onSubmit:function(e){return w.apply(this,arguments)},children:[Object(N.jsxs)(O.a.Group,{id:"email",children:[Object(N.jsx)(O.a.Label,{children:"Email"}),Object(N.jsx)(O.a.Control,{type:"email",ref:e,placeholder:"Email",required:!0})]}),Object(N.jsxs)(O.a.Group,{id:"password",children:[Object(N.jsx)(O.a.Label,{children:"Password"}),Object(N.jsx)(O.a.Control,{type:"password",ref:t,placeholder:"Password",required:!0})]}),Object(N.jsx)(f.a,{type:"submit",className:"w-100",children:"Log In"})]}),Object(N.jsx)("div",{className:"w-100 text-center mt-2",children:Object(N.jsx)(i.b,{to:"/forgot-password",children:"Forgot Password?"})})]})}),Object(N.jsxs)("div",{disabled:m,className:"w-100 text-center mt-2",children:["Don't have an account? ",Object(N.jsx)(i.b,{to:"/signup",children:"Sign Up"})]})]})},U=function(){var e=Object(c.useRef)(),t=P().forgotPassword,r=Object(c.useState)(""),n=Object(u.a)(r,2),a=n[0],s=n[1],l=Object(c.useState)(""),o=Object(u.a)(l,2),p=o[0],x=o[1],m=Object(c.useState)(!1),v=Object(u.a)(m,2),g=v[0],w=v[1];function y(){return(y=Object(j.a)(d.a.mark((function r(c){return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return c.preventDefault(),r.prev=1,x(""),s(""),w(!0),r.next=7,t(e.current.value);case 7:x("Check E-mail for further instructions."),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),s("Failed to reset password");case 13:w(!1);case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))).apply(this,arguments)}return Object(N.jsxs)(I,{children:[Object(N.jsx)(b.a,{children:Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h2",{className:"text-center mb-4",children:"Password Reset"}),a&&Object(N.jsx)(h.a,{variant:"danger",children:a}),p&&Object(N.jsx)(h.a,{variant:"success",children:p}),Object(N.jsxs)(O.a,{onSubmit:function(e){return y.apply(this,arguments)},children:[Object(N.jsxs)(O.a.Group,{id:"email",children:[Object(N.jsx)(O.a.Label,{children:"Email"}),Object(N.jsx)(O.a.Control,{type:"email",ref:e,placeholder:"Email",required:!0})]}),Object(N.jsx)(f.a,{type:"submit",className:"w-100",children:"Reset Password"})]}),Object(N.jsx)("div",{className:"w-100 text-center mt-2",children:Object(N.jsx)(i.b,{to:"/login",children:"Log In"})})]})}),Object(N.jsxs)("div",{disabled:g,className:"w-100 text-center mt-2",children:["Don't have an account? ",Object(N.jsx)(i.b,{to:"/signup",children:"Sign Up"})]})]})},R=function(){var e=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),n=P(),a=n.currentUser,s=n.updateEmail,o=n.updatePassword,d=Object(l.g)(),j=Object(c.useState)(""),p=Object(u.a)(j,2),x=p[0],m=p[1],v=Object(c.useState)(!1),g=Object(u.a)(v,2),w=g[0],y=g[1];return Object(N.jsxs)(I,{children:[Object(N.jsx)(b.a,{children:Object(N.jsxs)(b.a.Body,{children:[Object(N.jsx)("h2",{className:"text-center mb-4",children:"Update Profile"}),x&&Object(N.jsx)(h.a,{variant:"danger",children:x}),Object(N.jsxs)(O.a,{onSubmit:function(c){if(c.preventDefault(),t.current.value!==r.current.value)return m("Passwords do not match!!");var n=[];y(!0),m(""),e.current.value!==a.email.value&&n.push(s(e.current.value)),t.current.value&&n.push(o(t.current.value)),Promise.all(n).then((function(){d.push("/user")})).catch((function(){m("Failed to Update Pofile")})).finally((function(){y(!1)}))},children:[Object(N.jsxs)(O.a.Group,{id:"email",children:[Object(N.jsx)(O.a.Label,{children:"Email"}),Object(N.jsx)(O.a.Control,{type:"email",ref:e,placeholder:"Email",defaultValue:a.email})]}),Object(N.jsxs)(O.a.Group,{id:"password",children:[Object(N.jsx)(O.a.Label,{children:"Password"}),Object(N.jsx)(O.a.Control,{type:"password",ref:t,placeholder:"Password",required:!0})]}),Object(N.jsxs)(O.a.Group,{id:"passwordConfirm",children:[Object(N.jsx)(O.a.Label,{children:"Password Confirmation"}),Object(N.jsx)(O.a.Control,{type:"password",ref:r,placeholder:"Confirm Password"})]}),Object(N.jsx)(f.a,{disabled:w,type:"submit",className:"w-100",children:"Update"})]})]})}),Object(N.jsx)("div",{className:"w-100 text-center mt-2",children:Object(N.jsx)(i.b,{to:"/user",children:"Cancel"})})]})},B=r(67);function A(e){var t=e.component,r=Object(B.a)(e,["component"]),c=P().currentUser;return Object(N.jsx)(l.b,Object(p.a)(Object(p.a)({},r),{},{render:function(e){return c?Object(N.jsx)(t,Object(p.a)({},e)):Object(N.jsx)(l.a,{to:"/login"})}}))}var D=r(97),G=r(96),q=r.p+"static/media/drive img.0b900c10.png";function W(){return Object(N.jsxs)(D.a,{bg:"light",expand:"sm",children:[Object(N.jsxs)(D.a.Brand,{as:i.b,to:"/",className:"d-flex align-items-center justify-content-center",children:[Object(N.jsx)("img",{alt:"",src:q,width:"20",height:"20",className:"d-inline-block align-top mr-2"}),"Drive"]}),Object(N.jsx)(G.a,{children:Object(N.jsx)(G.a.Link,{as:i.b,to:"/user",children:"Profile"})})]})}var T=r(41),z=r(94),H=r(35),J=r(36),K="select-folder",M="update-folder",V="set-child-folders",_="set-child-files",Y={name:"Root",id:null,path:[]};function Q(e,t){var r=t.type,c=t.payload;switch(r){case K:return{folderId:c.folderId,folder:c.folder,childFolders:[],childFiles:[]};case M:return Object(p.a)(Object(p.a)({},e),{},{folder:c.folder});case V:return Object(p.a)(Object(p.a)({},e),{},{childFolders:c.childFolders});case _:return Object(p.a)(Object(p.a)({},e),{},{childFiles:c.childFiles});default:return e}}function X(e){var t=e.currentFolder,r=Object(c.useState)(!1),n=Object(u.a)(r,2),a=n[0],s=n[1],i=Object(c.useState)(""),l=Object(u.a)(i,2),o=l[0],d=l[1],j=P().currentUser,b=function(){s(!1)};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(f.a,{onClick:function(){s(!0)},variant:"outline-success",size:"sm",children:Object(N.jsx)(H.a,{icon:J.d})}),Object(N.jsx)(z.a,{show:a,onHide:b,children:Object(N.jsxs)(O.a,{onSubmit:function(e){if(e.preventDefault(),null!=t){var r=Object(T.a)(t.path);t!==Y&&r.push({name:t.name,id:t.id}),g.folders.add({name:o,parentId:t.id,userId:j.uid,path:r,createdAt:g.getCurrentTimeStamp()}),d(""),b()}},children:[Object(N.jsx)(z.a.Body,{children:Object(N.jsxs)(O.a.Group,{children:[Object(N.jsx)(O.a.Label,{children:"Folder Name"}),Object(N.jsx)(O.a.Control,{type:"text",value:o,onChange:function(e){return d(e.target.value)},required:!0})]})}),Object(N.jsxs)(z.a.Footer,{children:[Object(N.jsx)(f.a,{variant:"secondary",onClick:b,children:"Cancel"}),Object(N.jsx)(f.a,{type:"submit",variant:"success",children:"Add Folder"})]})]})})]})}var Z=r(99),$=r(98),ee=r(101);function te(e){var t=e.currentFolder,r=Object(c.useState)([]),n=Object(u.a)(r,2),a=n[0],i=n[1],l=P().currentUser;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("label",{className:"btn btn-outline-success btn-sm m-0 mr-2",children:[Object(N.jsx)(H.a,{icon:J.b}),Object(N.jsx)("input",{type:"file",onChange:function(e){var r=e.target.files[0];if(null!=t&&null!=r){var c=Object(Z.a)();i((function(e){return[].concat(Object(T.a)(e),[{id:c,name:r.name,progress:0,error:!1}])}));var n=t===Y?"".concat(t.path.join("/"),"/").concat(r.name):"".concat(t.path.join("/"),"/").concat(t.name,"/").concat(r.name),a=w.ref("/files/".concat(l.uid,"/").concat(n)).put(r);a.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes;i((function(e){return e.map((function(e){return e.id===c?Object(p.a)(Object(p.a)({},e),{},{progress:t}):e}))}))}),(function(){i((function(e){return e.map((function(e){return e.id===c?Object(p.a)(Object(p.a)({},e),{},{error:!0}):e}))}))}),(function(){i((function(e){return e.filter((function(e){return e.id!==c}))})),a.snapshot.ref.getDownloadURL().then((function(e){g.files.where("name","==",r.name).where("userId","==",l.uid).where("folderId","==",t.id).get().then((function(c){var n=c.docs[0];n?n.ref.update({url:e}):g.files.add({url:e,name:r.name,createdAt:g.getCurrentTimestamp(),folderId:t.id,userId:l.uid})}))}))}))}},style:{opacity:0,position:"absolute",left:"-9999px"}})]}),a.length>0&&s.a.createPortal(Object(N.jsx)("div",{style:{position:"absolute",bottom:"1rem",right:"1rem",maxWidth:"250px"},children:a.map((function(e){return Object(N.jsxs)($.a,{onClose:function(){i((function(t){return t.filter((function(t){return t.id!==e.id}))}))},children:[Object(N.jsx)($.a.Header,{closeButton:e.error,className:"text-truncate w-100 d-block",children:e.name}),Object(N.jsx)($.a.Body,{children:Object(N.jsx)(ee.a,{animated:!e.error,variant:e.error?"danger":"primary",now:e.error?100:100*e.progress,label:e.error?"Error":"".concat(Math.round(100*e.progress),"%")})})]},e.id)}))}),document.body)]})}var re=r(102);function ce(e){var t=e.currentFolder,r=t===Y?[]:[Y];return t&&(r=[].concat(Object(T.a)(r),Object(T.a)(t.path))),Object(N.jsxs)(re.a,{className:"flex-grow-1",listProps:{className:"bg-white pl-0 m-0"},children:[r.map((function(e,t){return Object(N.jsx)(re.a.Item,{linkAs:i.b,linkProps:{to:{pathname:e.id?"/folder/".concat(e.id):"/",state:{folder:Object(p.a)(Object(p.a)({},e),{},{path:r.slice(1,t)})}}},className:"text-truncate d-inline-block",style:{maxWidth:"150px"},children:e.name},e.id)})),t&&Object(N.jsx)(re.a.Item,{className:"text-truncate d-inline-block",style:{maxWidth:"200px"},active:!0,children:t.name})]})}function ne(e){var t=e.folder;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(f.a,{as:i.b,to:{pathname:"/folder/".concat(t.id),state:{folder:t}},variant:"outline-dark",className:"text-truncate w-100",children:[Object(N.jsx)(H.a,{icon:J.c,className:"mr-2"}),t.name]})})}function ae(e){var t=e.file;return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("a",{href:t.url,target:"_blank",className:"btn btn-outline-dark text-truncate w-100",children:[Object(N.jsx)(H.a,{icon:J.a,className:"mr-2"}),t.name]})})}function se(){var e=Object(l.i)().folderId,t=Object(l.h)().state,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(c.useReducer)(Q,{folderId:e,folder:t,childFolders:[],childFiles:[]}),n=Object(u.a)(r,2),a=n[0],s=n[1],i=P().currentUser;return Object(c.useEffect)((function(){s({type:K,payload:{folderId:e,folder:t}})}),[e,t]),Object(c.useEffect)((function(){if(null==e)return s({type:M,payload:{folder:Y}});g.folders.doc(e).get().then((function(e){s({type:M,payload:{folder:g.formatDoc(e)}})})).catch((function(){s({type:M,payload:{folder:Y}})}))}),[e]),Object(c.useEffect)((function(){return g.folders.where("parentId","==",e).where("userId","==",i.uid).orderBy("createdAt").onSnapshot((function(e){s({type:V,payload:{childFolders:e.docs.map(g.formatDoc)}})}))}),[e,i]),Object(c.useEffect)((function(){return g.files.where("folderId","==",e).where("userId","==",i.uid).orderBy("createdAt").onSnapshot((function(e){s({type:_,payload:{childFiles:e.docs.map(g.formatDoc)}})}))}),[e,i]),a}(e,(void 0===t?{}:t).folder),n=r.folder,a=r.childFolders,s=r.childFiles;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(W,{}),Object(N.jsxs)(C.a,{fluid:!0,children:[Object(N.jsxs)("div",{className:"d-flex align-items-center",children:[Object(N.jsx)(ce,{currentFolder:n}),Object(N.jsx)(te,{currentFolder:n}),Object(N.jsx)(X,{currentFolder:n})]}),a.length>0&&Object(N.jsx)("div",{className:"d-flex flex-wrap",children:a.map((function(e){return Object(N.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(N.jsx)(ne,{folder:e})},e.id)}))}),a.length>0&&s.length>0&&Object(N.jsx)("hr",{}),s.length>0&&Object(N.jsx)("div",{className:"d-flex flex-wrap",children:s.map((function(e){return Object(N.jsx)("div",{style:{maxWidth:"250px"},className:"p-2",children:Object(N.jsx)(ae,{file:e})},e.id)}))})]})]})}var ie=function(){return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(i.a,{children:Object(N.jsx)(S,{children:Object(N.jsxs)(l.d,{children:[Object(N.jsx)(A,{exact:!0,path:"/",component:se}),Object(N.jsx)(A,{exact:!0,path:"/folder/:folderId",component:se}),Object(N.jsx)(A,{path:"/user",component:E}),Object(N.jsx)(A,{path:"/update-profile",component:R}),Object(N.jsx)(l.b,{path:"/signup",component:k}),Object(N.jsx)(l.b,{path:"/login",component:L}),Object(N.jsx)(l.b,{path:"/forgot-password",component:U})]})})})})};r(85);s.a.render(Object(N.jsx)(n.a.StrictMode,{children:Object(N.jsx)(ie,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.922a5e5f.chunk.js.map